name: continuous-integration-foo

on:
    pull_request:
        branches:
            = master

jobs:
    build-and-test:
        runs-on: ubuntu-latest
	strategy:
	  matrix:
	    python-version: [3.5, 3.6, 3.7, 3.8]

        steps:
            - uses: actions/checkout@v1

            - name: Set up JDK 1.8
              uses: actions/setup-java@v1
              with:
                  java-version: 1.8

            - name: Build with Gradle!
              working-directory: ./src/Platform
              run: ./gradlew build -x test

            - name: Run tests
              working-directory: .
              run: ./gradlew test
    integration-test:
	runs-on: ubuntu-latest
	strategy:
	  matrix:
	    python-version: [3.5, 3.6, 3.7, 3.8]

	steps:
	    - uses:
		actions/checkout@v1
	    - name: Start docker server
	      working-directory: .
	      run: docker-compose up -d --build
	    - name: Set up Python ${{ matrix.python-version }}
	      uses: actions/setup-python@v1
	      with:
		python-version: ${{ matrix.python-version }}
	    - name: Install dependencies
	      run: |
		pip3 install -U requests
	    - name: Test with pytest
	      run: |
	        pip3 install -U pytest
		pytest
	    - name: Stop docker server
	      run: docker-compose down
